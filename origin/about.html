<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>About • Banking Login WAF Demo</title>
  <style>
    :root{
      --bg:#0b1020; --card:#111827; --muted:#9ca3af; --text:#e5e7eb; --brand:#2563eb; --line:#1f2937; --ink:#cbd5e1; --good:#10b981; --bad:#ef4444;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;background:var(--bg);color:var(--text);line-height:1.6}
    .wrap{max-width:1000px;margin:0 auto;padding:2.5rem 1.25rem}
    .card{background:var(--card);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.35);overflow:hidden}
    header{padding:2rem 1.5rem;border-bottom:1px solid var(--line)}
    header h1{margin:0 0 .25rem;font-size:1.6rem}
    header p{margin:.25rem 0 0;color:var(--muted)}
    .content{padding:1rem 1.5rem 2rem;display:grid;gap:1.25rem}
    h2{font-size:1.15rem;margin:1rem 0 .25rem}
    p{margin:.25rem 0}
    .grid{display:grid;gap:1rem}
    @media(min-width:840px){ .grid{grid-template-columns:repeat(3,1fr)} }
    .tile{background:#0b1220;border:1px solid var(--line);border-radius:12px;padding:1rem}
    .badge{display:inline-block;font-size:.8rem;background:#0e162b;border:1px solid var(--line);padding:.25rem .5rem;border-radius:999px;color:var(--muted)}
    a{color:var(--brand);text-decoration:none}
    .cta{margin-top:.5rem;display:inline-flex;gap:.5rem;flex-wrap:wrap}
    .btn{display:inline-block;background:var(--brand);color:#fff;font-weight:600;padding:.6rem .8rem;border-radius:.6rem}
    .btn.outline{background:transparent;color:var(--text);border:1px solid var(--line)}
    code{background:#0e162b;border:1px solid var(--line);padding:.15rem .35rem;border-radius:6px}

    /* Flowchart */
    .flow-wrap{background:#0e162b;border:1px solid var(--line);border-radius:12px;padding:1rem}
    svg{width:100%;height:auto;display:block}
    .node{fill:#0b1220;stroke:var(--line);stroke-width:1.5}
    .node-title{font-weight:700;fill:var(--text)}
    .node-sub{fill:var(--muted);font-size:12px}
    .edge{stroke:var(--ink);stroke-width:2.5;fill:none;marker-end:url(#arrow)}
    .edge.dash{stroke-dasharray:6 6;animation: dash 8s linear infinite}
    .edge.good{stroke:var(--good)}
    .edge.bad{stroke:var(--bad)}
    .step{fill:#0b1220;stroke:var(--line);stroke-width:1;rx:12;ry:12}
    .step-num{fill:#fff;font-weight:700}
    .label{fill:var(--muted);font-size:12px}
    @keyframes dash { to { stroke-dashoffset:-1000; } }

    .legend{display:flex;gap:1rem;flex-wrap:wrap;color:var(--muted);font-size:.9rem;margin-top:.75rem}
    .legend span{display:inline-flex;align-items:center;gap:.4rem}
    .dot{width:14px;height:3px;background:var(--ink);display:inline-block;border-radius:2px}
    .dot.good{background:var(--good)}
    .dot.bad{background:var(--bad)}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body>
  <div class="wrap">
    <nav style="display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem">
      <div style="display:flex;align-items:center;gap:.75rem">
        <div style="width:10px;height:10px;border-radius:50%;background:var(--brand)"></div>
        <strong>Banking Login WAF (Demo)</strong>
        <span class="badge">canary credentials</span>
        <span class="badge">geo policy</span>
      </div>
      <div class="cta">
        <a class="btn outline" href="/login">Login</a>
      </div>
    </nav>

    <div class="card">
      <header>
        <h1>About this WAF</h1>
        <p>Transparent edge protection for your login page with instant blocks when “canary” credentials are used.</p>
      </header>

      <div class="content">

        <!-- HOW IT WORKS (Flowchart) -->
        <section>
          <h2>How it works</h2>
          <div class="flow-wrap">
            <svg viewBox="0 0 1000 460" role="img" aria-labelledby="how-title how-desc">
  
              <defs>
                <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="5" orient="auto">
                  <polygon points="0,0 10,5 0,10" fill="currentColor"></polygon>
                </marker>
                <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
                  <feDropShadow dx="0" dy="1.5" stdDeviation="2" flood-color="black" flood-opacity=".35"/>
                </filter>
              </defs>

              <!-- Nodes -->
              <!-- Browser -->
              <g filter="url(#shadow)">
                <rect class="node" x="30" y="180" width="160" height="90" rx="12" ry="12"/>
                <text class="node-title" x="110" y="212" text-anchor="middle">Browser / Client</text>
                <text class="node-sub"   x="110" y="233" text-anchor="middle">User or attacker</text>
              </g>

              <!-- WAF big -->
              <g filter="url(#shadow)">
                <rect class="node" x="235" y="60" width="360" height="340" rx="16" ry="16"/>
                <text class="node-title" x="415" y="86" text-anchor="middle">WAF (OpenResty)</text>
                <text class="node-sub"   x="415" y="104" text-anchor="middle">Lua access phase</text>

                <!-- Steps inside WAF -->
                <rect class="step" x="255" y="125" width="320" height="46"/>
                <text class="node-title" x="415" y="154" text-anchor="middle">1. Ban check (local + Redis)</text>

                <rect class="step" x="255" y="185" width="320" height="46"/>
                <text class="node-title" x="415" y="214" text-anchor="middle">2. GEO policy (optional)</text>

                <rect class="step" x="255" y="245" width="320" height="46"/>
                <text class="node-title" x="415" y="274" text-anchor="middle">3. Login inspect on POST /login</text>

                <rect class="step" x="255" y="305" width="320" height="46"/>
                <text class="node-title" x="415" y="334" text-anchor="middle">4. Proxy to origin if allowed</text>
              </g>

              <!-- Redis -->
              <g filter="url(#shadow)">
                <rect class="node" x="620" y="85" width="150" height="66" rx="12" ry="12"/>
                <text class="node-title" x="695" y="112" text-anchor="middle">Redis</text>
                <text class="node-sub"   x="695" y="132" text-anchor="middle">bans + canaries</text>
              </g>

              <!-- Origin -->
              <g filter="url(#shadow)">
                <rect class="node" x="780" y="180" width="190" height="120" rx="14" ry="14"/>
                <text class="node-title" x="875" y="212" text-anchor="middle">Origin</text>
                <text class="node-sub"   x="875" y="232" text-anchor="middle">unchanged site</text>
              </g>

              <!-- Edges -->
              <!-- Client -> WAF -->
              <g color="var(--ink)">
                <path class="edge" d="M190,225 C210,225 220,225 235,225"/>
              </g>
              <!-- WAF -> Origin -->
              <g color="var(--good)">
                <path class="edge good" d="M595,320 C720,320 720,240 780,240"/>
              </g>
              <!-- WAF -> Client (403) -->
              <g color="var(--bad)">
                <path class="edge bad dash" d="M255,330 C210,360 180,360 140,340"/>
                <text class="label" x="150" y="352">403 Forbidden (ban)</text>
              </g>
              <!-- WAF <-> Redis lookups -->
              <g color="var(--ink)">
                <path class="edge" d="M575,150 C590,150 600,150 620,150"/>
                <path class="edge" d="M620,130 C600,130 590,130 575,130"/>
              </g>

              <!-- Step badges -->
              <!-- <g filter="url(#shadow)">
                <rect class="step" x="218" y="210" width="26" height="26" rx="13" ry="13"/>
                <text class="step-num" x="231" y="228" text-anchor="middle" font-size="13">1</text>

                <rect class="step" x="218" y="270" width="26" height="26" rx="13" ry="13"/>
                <text class="step-num" x="231" y="288" text-anchor="middle" font-size="13">2</text>

                <rect class="step" x="218" y="330" width="26" height="26" rx="13" ry="13"/>
                <text class="step-num" x="231" y="348" text-anchor="middle" font-size="13">3</text>

                <rect class="step" x="740" y="228" width="26" height="26" rx="13" ry="13"/>
                <text class="step-num" x="753" y="246" text-anchor="middle" font-size="13">4</text>
              </g> -->

              <!-- Labels near edges -/->
              <text class="label" x="300" y="218">Apply local/global ban if any</text>
              <text class="label" x="300" y="278">Allow only configured countries</text>
              <text class="label" x="300" y="338">Hash (user + ␀ + pass) ⇒ Redis</text>
              <text class="label" x="865" y="270" text-anchor="middle">Allowed traffic</text>  -->
            </svg>

            <!-- Accessible text fallback -->
            <ol class="sr-only">
              <li>Check if the source is banned locally or in Redis; if so, return 403.</li>
              <li>Apply optional GEO allow/block rules.</li>
              <li>On POST /login, hash username + NUL + password and check if it’s a canary; if match, ban and return 403.</li>
              <li>If allowed, proxy the request to the origin site.</li>
            </ol>

            <div class="legend">
              <span><i class="dot"></i> normal edge</span>
              <span><i class="dot good"></i> allowed to origin</span>
              <span><i class="dot bad"></i> blocked (403)</span>
            </div>
          </div>
        </section>

        <!-- (Keep any other sections you have below) -->
        <section class="grid">
          <div class="tile">
            <h2>Key benefits</h2>
            <ul>
              <li>Turns phishing kits against themselves using canary creds.</li>
              <li>Cuts brute-force noise before it hits your app.</li>
              <li>No password logging; canaries stored as SHA-256 hashes.</li>
            </ul>
          </div>
          <div class="tile">
            <h2>Admin API</h2>
            <ul>
              <li>Add/remove canaries by hash or plaintext (hashed at WAF).</li>
              <li>Ban/unban IPs, list active bans with TTLs.</li>
              <li>Guarded by CIDR allowlist + token; mTLS/SSO optional.</li>
            </ul>
          </div>
          <div class="tile">
            <h2>Endpoints</h2>
            <ul>
              <li><code>GET /login</code> — demo login page.</li>
              <li><code>POST /login</code> — submission (inspected by WAF).</li>
              <li><code>GET /</code> — this page.</li>
              <li><code>/admin/*</code> — Admin API (restricted).</li>
            </ul>
          </div>
        </section>
      </div>

      <footer style="padding:1.25rem 1.5rem;border-top:1px solid var(--line);color:var(--muted);font-size:.9rem">
        Built for demos: OpenResty (NGINX + LuaJIT) + Redis. Optional MaxMind GEO policy. No application changes required.
      </footer>
    </div>
  </div>
</body>
</html>
